我们假设甲和乙之间要发起一笔交易，甲先发起一个请求——我要创建一个新的区块（一个新交易），就会被广播给网络里的所有用户，所有用户验证同意后该区块就被添加到主链上。这条链上拥有永久和透明可查的交易记录，也就是我们说的时间戳。全网一本账，每个人都可以查找。

![image](http://p1.pstatp.com/large/616b0002f627a3c5daba)

> 区块链技术实际上是一个分布式数据库，在这个数据库中记账不是由个人或者某个中心化的主体来控制的（例如你的资产是被银行数据中心记录的，你的信用被芝麻信用记录着），而是由所有节点共同维护、共同记账的。所有的单一节点都无法篡改它。

如果你想篡改一个记录，你需要同时控制整个网络超过51%的节点或计算能力才可以，而区块链中的节点无限多且无时无刻都在增加新的节点，这基本上是不可能完成的事情，而且篡改的成本非常高，几乎任何人都承担不起。这也就是非常安全的。


# 区块链的特性
- 去中心化：因为它是分布式存储的，所以不存在中心点，也可以说各个节点都是中心点，生活中应用就是不需要第三方系统了（银行、支付宝、房产中介等都属于第三方）。

- 开放性：区块链的系统数据是公开透明的，每个人都可以参与进来，比如租房子，你可以知道这个房子以前的出租信息，有没出现过问题，当然这里头的一些个人私有信息是加密的。

- 自治性：区块链采用基于协商一致的规范和协议（比如一套公开透明的算法），然后各个节点就按照这个规范来操作，这样就是所有的东西都由机器完成，就没有人情成分。 使得对"人"的信任改成了对机器的信任，任何人为的干预不起作用。

- 信息不可篡改：如果信息存储到区块链中就被永久保存，是没办法去改变，至于 51% 攻击，基本不可能实现。

- 匿名性：区块链上面没有个人的信息，因为这些都是加密的，是一堆数字字母组成的字符串，这样就不会出现你的各种身份证信息、电话号码被倒卖的现象。

概括起来，区块链是一个放在非安全环境中的分布式数据库（系统），区块链采用密码学的方法来保证已有数据不可能被篡改，区块链采用共识算法来对于新增数据达成共识。 

# 区块结构
区块包含两个部分：

1、区块头（Head）：记录当前区块的元信息

2、区块体（Body）：实际数据

包含数据如下图所示：
![image](http://p1.pstatp.com/large/pgc-image/15211218379562e8d2d309a)

# 区块链如何工作
我们以转账为例:

目前我们转账都是中心化的，银行是一个中心化账本，例如 A 账号里有 400 块钱，B 账号里有 100 块钱。

当 A 要转 100 块钱给 B 时，A 要通过银行提交转账申请，银行验证通过后，就从 A 账号上扣除 100 块，B 账号增加 100 块。

计算后 A 账号扣除 100 后余额为300元，B 账号加上 100 后余额为 200 元。

![image](http://p3.pstatp.com/large/pgc-image/1521121904633d042daa96a)

区块链上转账的步骤则是：A 要转账给 B 100 块钱，A 就会在网络上把要转账的这个信息告诉大家，大家会去查看 A 的账户上是否有足够的钱去完成这个转账，如果验证通过后，大家就把这个信息都记录到自己的电脑上区块链中，且每个人记入的信息都是同步一致的，这样 A 就顺利将 100 块钱转移到了 B 的账户上。可以看到这中间并没有银行啥事。

![image](http://p1.pstatp.com/large/pgc-image/15211219465379fa31733de)

# 区块链需要了解的关键技术点
通过 Hash 与 非对称加密来保障数据无法被篡改：

> Hash：y = hash(x)，对 x 进行哈希运算得出 y，可以隐藏原始信息 x，因为你没办法通过 y 来算出 x，从而做到匿名性。

> 非对称加密：公开密钥与私有密钥是一对，如果用公开密钥对数据进行加密，只有用对应的私有密钥才能解密；如果用私有密钥对数据进行加密，那么只有用对应的公开密钥才能解密。

> 共识算法：保障节点与节点之间的数据一致性。

# 有没一两句话能说明白区块链的？

有的。

麻将作为中国传统的区块链项目，四个矿工一组，先碰撞出13个数字正确哈希值的矿工可以获得记账权并得到奖励。

# 数据存储方式
比特币采用了一种更加简单直接的方式，利用P2P协议维护整个比特币网络集群，不需要某个中心节点协调节点之间的通信，不需要所有机器投票维护集群状态。而是通过P2P协议进行节点之间的数据传输，任何节点都可以随时加入或者离开比特币网络集群，而不会对比特币网络集群产生影响，也不需要特意去修复这个集群中的故障机器。

利用P2P协议进行节点之间数据传输主要有 两个功能点 ：

1. 把需要存储的数据广播到所有节点上进行储存。
2. 查询整个网络集群中所有节点的最新数据，如果自己节点的数据与大部分节点的数据不一致，则更新自身的数据与大部分节点存储的数据一致。

**比特币是去中心化存储，最大的风险是整个比特币网络集群被破坏，篡改了整个网络存储的数据**。但是上述第二个功能点能够有效的防止这种风险，由于系统会自动更新为整个集群中大部分节点存储的相同数据，所以要篡改数据，必须要同时篡改整个网络一半以上的数据，这不是说做不到，但是比特币利用区块链的方式再加上利益博弈机制，当你拥有这种能力的时候，也不需要去做篡改这种投入产出比这么低的事了。

通过图示看一下比特币网络结构的运行：
![image](http://p9.pstatp.com/large/6ecb000a9e6ba5a64af4)
Jack把某一笔交易数据往A服务器上提交，A服务器验证数据合法性后存储到自身的数据库中，同时把这笔交易数据点对点的传输到比特币网络集群的所有B，C，D，E节点上。A和所有其它的B，C，D，E节点保持点对点通信，自动更新为这个集群中大多数节点维护的相同的数据。如果B，C，D三台服务器保存的数据相同，但是与A，E不一致，则A和E自动更新为与B，C，D相同的数据。所以Jack的这笔交易，需要等待这个比特币网络集群中所有节点都接受到，并且认为合法存储后，才认为这笔交易成功完成。当然在现实情况下，不需要等待所有节点都确认完成，通常只需要少数服务器确认完成后即可认为交易完成，因为每个服务器维护的自身与整个网络集群的数据状态，当少量服务器都认为与整个集群一致时，此时从概率上就是一致的。