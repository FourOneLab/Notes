## Kubernetes是什么？
全新的基于容器技术的分布式架构领先方案。目的是实现资源管理的自动化，以及跨多个数据中心的资源利用率的最大化。

如果系统的设计遵循Kubernetes的设计思想，那么传统架构中那些和业务没有多大关系的底层代码或功能模块，都可以立刻从我们的视线中消失。
- 不必再考虑负载均衡器的选型和部署实施问题
- 不必再考虑引入或者自己开发一个复杂的服务治理框架
- 不必再头疼服务监控和故障处理模块的开发
- 将精力集中于业务本身

Kubernetes是一个开放的平台，主流编程语言编写的服务，都可以毫无困难地映射为Kubernetes的Service，并通过标准的TCP通信协议进行交互。

Kubernetes是一个完备的分布式系统支撑平台，具有完备的集群管理能力，包括：
- 多层次的安全防护和准入机制
- 多租户应用支撑能力
- 透明的服务注册和服务发现机制
- 内建只能负载均衡器
- 强大的故障发现和自我修复能力
- 服务滚动升级和在线扩容能力
- 可扩展的资源调度机制
- 多粒度的资源配额管理能力

Kubernetes还提供了完善的管理工具，涵盖了：
- 开发
- 部署测试
- 运维监控

**Kubernetes是一个基于容器技术的分布式架构解决方案，是一个一站式的完备的分布式系统开发和支撑平台。**

#### Service（服务）是分布式集群架构的核心
一个Service对象拥有如下关键特征：
- 唯一指定的名字
- 虚拟IP（Cluster IP、Service IP、 VIP）和端口号
- 能够提供某种远程服务能力
- 被映射到了提供这种服务能力的一组容器应用上

>Service的服务进程目前都基于Socket通信方式对外提供服务

>虽然一个Service通过由多个相关的服务进程来提供服务，每个服务进程都有一个独立的Endpoint（Ip+Port）访问点，但Kubernetes能够让我们通过Service（虚拟Cluster IP + Service Port）连接指定的Service上。**这个Service本身一旦创建就不在变化。**


容器提供了强大的隔离功能，所以有必要把为Service提供服务的这组进行放入容器中进行隔离。为此，Kubernetes设计了Pod对象，将每个服务进行包装到相拥的Pod中，使其成为Pod中运行的容器。

为了建立Pod和Service的关联关系，Kubernetes给每个Pod贴上一个标签（Label），然后给相应的Service定义标签选择器（Label Selector），这样就巧妙的解决了Service和Pod的关联问题。

#### Pod
- Pod运行在一个称之为节点（Node）的环境中，这个节点可以是物理机，也可以是公有云或者私有云中的一台虚拟机，通常一个节点运行几百个Pod
- 每个Pod中运行着一个特殊的容器称为Pause，其他容器称为业务容器，所有业务容器共享Pause容器的网络栈和Volume挂载卷，这样业务容器之间的通信和数据交换非常高效
- 需要注意的是，并不是每个Pod和它里面运行的容器都能映射到一个Service上，只有那些提供服务（对内或者对外）的一组Pod才会被映射到一个Service。


#### 集群管理
Kubernetes将集群中的机器划分为一个Master节点和一群工作节点Node。

**Master上运行的进程：**
- kube-apiserver
- kube-controller-manager
- kube-scheduler

这些进程实现的功能（全自动）：
- 资源管理
- Pod调度
- 弹性伸缩
- 安全控制
- 系统监控
- 纠错

**Node上运行的进程：**
- 运行真正的应用程序
- kubelet
- kube-proxy

这些进程实现的功能：
- Pod的创建、启动、监控、重启、销毁
- 实现软件模式的负载均衡器

Node上Kubernetes管理的最小运行单元是Pod。

#### 服务扩容
- 为需要扩容的Service所关联的Pod创建一个RC（Replication Controller）
- 一个RC定义文件中包括以下3个关键信息：
    - 目标Pod的定义
    - 目标Pod需要运行的副本数量（Replicas）
    - 要监控的目标Pod的标签（Label）

定义RC方便的解决了Service的扩容和升级问题。


## 为啥用Kubernetes？
==IT从来都是一个由新技术驱动的行业。==

#### 带来的好处：
- 可以轻装上阵地开发复杂系统了
- 使用Kubernetes就是在全面拥抱微服务架构
> 微服务架构的核心是将一个巨大的单体应用分解为很多小的相互连接的微服务，一个微服务背后可能有多个实例副本在支撑，副本的数量可能会随着系统的负荷变化而进行调整，内嵌的负载均衡器在这里发挥了重要作用。

>微服务架构使得每个服务都可以由专门的开发团队来开发，开发者可以自由的选择开发技术，并且每个微服务独立开发、升级、扩展，因此系统具备很高的稳定性和快速迭代进化的能力。

- 系统可以随时随地地整体搬迁到公有云上
>在Kubernetes的架构方案中，底层网络的细节完全被屏蔽，基于服务的Cluster
IP甚至都无须我们改变运行期的配置文件，就能将系统从物理机环境中无缝迁移到公有云中，或者在服务高峰期将部分服务对应的Pod副本放入公有云中以提升系统的吞吐量。

- Kubernetes系统架构具备超强的横向扩容能力

